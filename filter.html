<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="css/styles.css">
  <title>Kaffekapslen</title>
</head>
<body>
<header><img src="images/header.jpg" alt=""></header>
<section class="container">


<label for="">
  <select class="" name="">
  <option disabled selected>Styrke</option>
    <option id="Mild">Mild</option>
      <option id="Medium">Medium</option>
        <option id="Stærk">Stærk</option>
  </select>
</label>
<label for="">
  <select class="" name="">
    <option disabled selected>Størrelse</option>
    <option id="Ristretto">Ristretto</option>
    <option id="Espresso">Espresso</option>
    <option id="Lungo">Lungo</option>
    <option id="Almindelig">Almidelig kop</option>
  </select>
</label>
<label for="">
  <select class="" name="">
    <option disabled selected>Kvalitet</option>
    <option>Kvalitet</option>
    <option>Kvalitet</option>
  </select>
</label>
<label for="">
  <select class="" name="">
    <option disabled selected>Brand</option>
    <option id="Bosch">Bosch</option>
    <option id="Kaffekapslen">Kaffekapslen</option>
    <option id="LOr">LOr</option>
    <option id="PeterLarsen">Peter Larsen</option>
    <option id="BKI">BKI</option>
    <option id="Lofbergs">Löfbergs</option>
    <option id="Gimoka">Gimoka</option>
    <option id="Segafredo">Segafredo</option>
    <option id="Caferene">Café René</option>
    <option id="Lavazza">Lavazza</option>
    <option id="GranCaffe">Gran Caffé Garibaldi</option>
    <option id="Gevalia">Gevalia</option>
    <option id="CarteNoire">Carte Noire</option>
  </select>
</label>
<label for="">
  <select class="" name="">
    <option disabled selected>Sortering</option>
    <option>Sortering</option>
    <option>Sortering</option>
  </select>
</label>
<div class="container__checkboxes">
<label><input name="organic" id="Organic" type="checkbox"/> Økologisk</label>
<label><input id="Frugtig" type="checkbox"/> Frugtig</label>
<label><input id="Dark" type="checkbox"/> Mørkristet</label>

<label><input id="Aromatisk" type="checkbox"/> Aromatisk Arabica</label>
<label><input id="Tilbehør" type="checkbox"/> Tilbehør</label>
<label><input id="Bigpack" type="checkbox"/> Big pack</label>

<label><input id="Koffeinfri" type="checkbox"/> Koffeinfri</label>
<label><input id="Karamel" type="checkbox"/> Karamel</label>
<label><input id="Te" type="checkbox"/> Te</label>

<!-- <input type="checkbox"> <label for="">Syrlighed</label> -->
</div>
<button type="button" id="search" class="container__checkboxes__submit">Søg</button>


<hr>
<p id="results"></p>
<table id="demo2"></table>
<table id=demo></table>

</section>
<script>

document.getElementById("search").addEventListener("click", loadXMLDoc);

function loadXMLDoc(){
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
    resultcount(this);
    myFunction(this);
    }
};
xhttp.open("GET", "productFeedForNespresso.xml", true);
xhttp.send();
};


//      ||



function myFunction(xml) {
  let i;
  let xmlDoc = xml.responseXML;
  let table = "";
  let organictable ="";
  let tilbehørtable ="";
  let Koffeinfritable ="";
  let bigpacktable ="";
  let aromatisktable ="";
  let tetable ="";
  let darktable ="";
  let karameltable="";
  let frugtigtable ="";
  let ristrettotable="";
  let espressotable ="";
  let lungotable ="";
  let almindeligtable ="";
  let mildtable ="";
  let mediumtable ="";
  let strongtable ="";
  let testtable="";
  let x = xmlDoc.getElementsByTagName("item");
  let sprice = xmlDoc.getElementsByTagName("specialPrice");
  // let cities = sprice.filter(val => {
  //   return val !== "undefined";
  // });

  // if (sprice.textContent !== "undefined"){
  // // var nodeList = sprice.textContent;
  // // var nodeArray = [];
  // // for ( i = 0; i < nodeList.length; ++i) {
  // //   nodeArray[i] = nodeList[i];
  // //   console.log(nodeArray);
//    var myNodeList = xmlDoc.getElementsByTagName("specialPrice");
// var myArrayFromNodeList = []; // empty at first
// for (i = 0; i < myNodeList.length; i++) {
//   myArrayFromNodeList.push(myNodeList[i]); // ahhh, push it
// }
// console.log(myNodeList); // NodeList
// console.log(myArrayFromNodeList); // Array of Nodes
//   var filtered = sprice.filter(function (el) {
//     sprice !=="undefined"
// });
// var data = [parseFloat(sprice[0].textContent).toFixed(2)];
// data = data.filter(function(element) {
//    return element !== undefined;
// });

// console.log(data);
// var newArray = x[i].getElementsByTagName('specialPrice').filter(function(item) {
//   return x[i].getElementsByTagName('specialPrice') !== "";
// });

var checkboxcounter = document.querySelectorAll('input[type="checkbox"]:checked').length;






// console.log(x[i].getElementsByTagName('specialPrice'));
    for (i = 0; i <x.length; i++) {
      let nodelist = x[i].getElementsByTagName('specialPrice');
      let priselist = x[i].getElementsByTagName("price");
      let strengthlist = x[i].getElementsByTagName("styrke");
      let egenskablist = x[i].getElementsByTagName("egenskaber");
      let sizelist = x[i].getElementsByTagName("cupsize");

    // let newArray =  Array.prototype.map.call( nodelist, function(n){
    // console.log(n.innerHTML);
    // });
    //



      let price = parseFloat(x[i].getElementsByTagName("price")[0].childNodes[0].nodeValue).toFixed(2);
      let title = x[i].getElementsByTagName("title")[0].childNodes[0].nodeValue;
      let a = x[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
      let img = x[i].getElementsByTagName("image_link")[0].childNodes[0].nodeValue;
      let sprice = x[i].getElementsByTagName("specialPrice");
      texts = Array.from(nodelist, node => node.textContent);
      newArray = Array.from(priselist, pris => pris.textContent);
      styrke = Array.from(strengthlist, strength => strength.textContent);
      egenskab = Array.from(egenskablist, egenskab => egenskab.textContent);
      cupsize = Array.from(sizelist, size => size.textContent);
    let items = Array.from(x, item => item.childNodes);   //
      xlist = Array.from(x, items => x);
      espresso = cupsize.filter(cupsize => x == "Espresso" || xlist == "Ristretto,Espresso,Lungo" );
      organicFilter = items.filter(items => items == "Komposterbar,Økologisk");
      organiclist = x[i].innerHTML.includes("Økologisk");
      // organicfilterX = x.filter(x => x == "Komposterbar,Økologisk");

tilbehørlist = x[i].innerHTML.includes("Tilbehør");
koffeinfrilist = x[i].innerHTML.includes("Koffeinfri");
bigpacklist = x[i].innerHTML.includes("Big pack");
aromatisklist = x[i].innerHTML.includes("Aromatisk");
telist = x[i].innerHTML.includes(" te");
darklist = x[i].innerHTML.includes("Mørkristede");
karamelliste = x[i].innerHTML.includes("Karamel");
frugtigliste = x[i].innerHTML.includes("Frugt");
ristrettoliste = x[i].innerHTML.includes("Ristretto");
espressoliste = x[i].innerHTML.includes("Espresso");
lungoliste = x[i].innerHTML.includes("Lungo");
almindeligliste = x[i].innerHTML.includes("Almindelig");

testliste = x[i].innerHTML.includes(" te") && x[i].innerHTML.includes("Fruit")

    //special price to price when specialprice is undefined
      if(typeof texts[i] === "undefined") {
          texts[i] = xmlDoc.getElementsByTagName("price")[i].childNodes[0].nodeValue;

   }

   var ristretto = document.getElementById("Ristretto")
   if(Ristretto.selected){
     if(ristrettoliste === true){
       ristrettotable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";

     }

   }
   var espresso = document.getElementById("Espresso")
   if(Espresso.selected){
     if(espressoliste === true){
       espressotable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
          if(Te.checked){
            if(telist === true){
              tetable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
                "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
                 "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
            }


    }
    if(Aromatisk.checked){
      if(aromatisklist === true){
        aromatisktable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
          "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
           "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
      }

    }


     }

   }
   var lungo = document.getElementById("lungo")
   if(Lungo.selected){
     if(lungoliste === true){
       lungotable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }
   var almindelig = document.getElementById("Almindelig")
   if(Almindelig.selected){
     if(almindeligliste === true){
      almindeligtable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }

   var mild = document.getElementById("Mild")
   if(Mild.selected){
     if(styrke[0] <5){
       if(typeof styrke !== "undefined"){
      mildtable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }}
   var Medium = document.getElementById("Medium")
   if(Medium.selected){
     if(styrke[0] >=5 && styrke[0] <=7 ){
       if(typeof styrke !== "undefined"){
      mildtable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }}
   var stærk = document.getElementById("stærk")
   if(Stærk.selected){
     if(styrke[0] >=8 ){
       if(typeof styrke !== "undefined"){
      strongtable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }}

var frugtig = document.getElementById("Frugtig")
if(Frugtig.checked){
  if(frugtigliste === true){
    frugtigtable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
      "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
       "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
  }

}




var aromatisk = document.getElementById("Aromatisk")

var karamel = document.getElementById("Karamel")
if(Karamel.checked){
  if(karamelliste === true){
    karameltable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
      "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
       "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
  }

}






   var bigpack = document.getElementById("Bigpack")
   if(Bigpack.checked){
     if(bigpacklist === true){
       bigpacktable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }

   var dark = document.getElementById("Dark")
   if(Dark.checked){
     if(darklist === true){
       darktable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }
   var koffeinfri = document.getElementById("Koffeinfri")
   if(Koffeinfri.checked){
     if(koffeinfrilist === true){
       Koffeinfritable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }

   var tilbehør = document.getElementById("Tilbehør")
   if(Tilbehør.checked){
     if(tilbehørlist === true){
       tilbehørtable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
          "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
     }

   }


//
// if(checkboxcounter == 9){
//   table += "<article id='article"+i+"'>" + "<a href='"+a+"'>" +
//     "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
//      "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
// }

var organic = document.getElementById("Organic")
if(organic.checked){
  if(organiclist === true){
    organictable +="<article class='article"+i+"'>" + "<a href='"+a+"'>" +
      "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
       "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p>"+ "<button class='readmore'>Læs mere</button>" +"</article>";
  }

}

// document.getElementsByClassName("specialprice").innerHTML = price;

};

document.getElementById("demo2").innerHTML = table;
document.getElementById("demo").innerHTML = organictable + tilbehørtable + Koffeinfritable+bigpacktable+aromatisktable+tetable+darktable+karameltable+frugtigtable+ristrettotable+espressotable+lungotable+almindeligtable+mildtable+mediumtable+strongtable+testtable;




};




function resultcount(xml) {
    var xmlDoc = xml.responseXML;
    x = xmlDoc.getElementsByTagName('title').length;
    document.getElementById("results").innerHTML = "Results: " +
    x;
};











//
//        + "<button class='readmore'>Læs mere</button>" + "</a></article>";
//   }
//
//   document.getElementById("demo2").innerHTML = table;
//
// // document.getElementsByClassName("price").innerHTML = price;
// // document.getElementsByClassName("sprice").innerHTML = sprice;
// };

//   }
//   };






//   var nodes = xmlDoc.getElementsByTagName('title'), //Get the var nodes <node> tags
//     amountOfNodes = nodes.length
//
// for(var i = 0; i < amountOfNodes; i++) { //loop thru the nodes
//
//   console.log(nodes[i].getElementsByTagName('title').length); //get the amount of <alarm> tags
//   document.getElementById("results").innerHTML = txt;
// };
// function my(xml) {
//     var x, i, txt, xmlDoc;
//     xmlDoc = xml.responseXML;
//     txt = "";
//     x = xmlDoc.getElementsByTagName("description");
//     for (i = 0; i < x.length; i++) {
//         txt += x[i].childNodes[0].nodeValue + "<br>";
//     }
//     document.getElementById("description").innerHTML = txt;
// }


    // x = xmlDoc.getElementsByTagName('title');
    // xLen = x.length;
    //
    // for (i = 0; i <xLen; i++) {
    //     txt += x[i].childNodes[0].nodeValue) + " ";
    // }

// function myFunction(xml) {
    // var x, i, xmlDoc, txt;
    // xmlDoc = xml.responseXML;
    // txt = "";
    // x = xmlDoc.getElementsByTagName('title');
    // for (i = 0 ; i <x.length; i++) {
    //     txt += x[i].childNodes[0].nodeValue + "<br>";
    // }
    // document.getElementById("demo").innerHTML = txt;

</script>

</body>
</html>

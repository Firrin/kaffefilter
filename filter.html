<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="css/styles.css">
  <title>Kaffekapslen</title>
</head>
<body>
<header><img src="images/header.jpg" alt=""></header>
<section class="container">


<label for=""><select class="" name=""><option disabled selected>Styrke</option></select></label>
<label for=""><select class="" name=""><option disabled selected>Størrelse</option></select></label>
<label for=""><select class="" name=""><option disabled selected>Kvalitet</option></select></label>
<label for=""><select class="" name=""><option disabled selected>Type</option></select></label>
<label for=""><select class="" name=""><option disabled selected>Sortering</option></select></label>
<div class="container__checkboxes">
<label><input type="checkbox"/> Økologisk</label>
<label><input type="checkbox"/> Frugtig</label>
<label><input type="checkbox"/> Mørkristet</label>

<label><input type="checkbox"/> Aromatisk Arabica</label>
<label><input type="checkbox"/> Chokolade</label>
<label><input type="checkbox"/> Lakrids</label>

<label><input type="checkbox"/> Koffeinfri</label>
<label><input type="checkbox"/> Karamel</label>
<label><input type="checkbox"/> The</label>

<!-- <input type="checkbox"> <label for="">Syrlighed</label> -->
</div>
<button type="button" id="search" class="container__checkboxes__submit">Søg</button>

<p id=demo></p>
<hr>
<p id="results"></p>
<table id="demo2"></table>

</section>
<script>

document.getElementById("search").addEventListener("click", loadXMLDoc);

function loadXMLDoc(){
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
    resultcount(this);
    myFunction(this);
    }
};
xhttp.open("GET", "productFeedForNespresso.xml", true);
xhttp.send();
};


//      ||



function myFunction(xml) {
  let i;
  let xmlDoc = xml.responseXML;
  let table="";
  let x = xmlDoc.getElementsByTagName("item");
  let sprice = xmlDoc.getElementsByTagName("specialPrice");
  // let cities = sprice.filter(val => {
  //   return val !== "undefined";
  // });

  // if (sprice.textContent !== "undefined"){
  // // var nodeList = sprice.textContent;
  // // var nodeArray = [];
  // // for ( i = 0; i < nodeList.length; ++i) {
  // //   nodeArray[i] = nodeList[i];
  // //   console.log(nodeArray);
//    var myNodeList = xmlDoc.getElementsByTagName("specialPrice");
// var myArrayFromNodeList = []; // empty at first
// for (i = 0; i < myNodeList.length; i++) {
//   myArrayFromNodeList.push(myNodeList[i]); // ahhh, push it
// }
// console.log(myNodeList); // NodeList
// console.log(myArrayFromNodeList); // Array of Nodes
//   var filtered = sprice.filter(function (el) {
//     sprice !=="undefined"
// });
// var data = [parseFloat(sprice[0].textContent).toFixed(2)];
// data = data.filter(function(element) {
//    return element !== undefined;
// });

// console.log(data);
// var newArray = x[i].getElementsByTagName('specialPrice').filter(function(item) {
//   return x[i].getElementsByTagName('specialPrice') !== "";
// });

// console.log(x[i].getElementsByTagName('specialPrice'));
    for (i = 0; i <x.length; i++) {
      let nodelist = x[i].getElementsByTagName('specialPrice');
      let priselist = x[i].getElementsByTagName("price");
      let strengthlist = x[i].getElementsByTagName("styrke");
      let egenskablist = x[i].getElementsByTagName("egenskab");
      let sizelist = x[i].getElementsByTagName("cupsize");
    // let newArray =  Array.prototype.map.call( nodelist, function(n){
    // console.log(n.innerHTML);
    // });
    //



      let price = parseFloat(x[i].getElementsByTagName("price")[0].childNodes[0].nodeValue).toFixed(2);
      let title = x[i].getElementsByTagName("title")[0].childNodes[0].nodeValue;
      let a = x[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
      let img = x[i].getElementsByTagName("image_link")[0].childNodes[0].nodeValue;
      let sprice = x[i].getElementsByTagName("specialPrice");
      texts = Array.from(nodelist, node => node.textContent)
      newArray = Array.from(priselist, pris => pris.textContent)
      styrke = Array.from(strengthlist, strength => strength.textContent)
      egenskab = Array.from(egenskablist, egenskab => egenskab.textContent)
      cupsize = Array.from(sizelist, size => size.textContent)
      xlist = Array.from(x, items => x.textContent)

      if(typeof texts[i] === "undefined") {
          texts[i] = xmlDoc.getElementsByTagName("price")[i].childNodes[0].nodeValue;
   }


            table += "<article>" + "<a href='"+a+"'>" +
            "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
             "<p class='specialprice'>"+parseFloat(texts.sort()).toFixed(2) +"</p></article>";

console.log(table)



// if(isNaN(texts)){
//   table += "<article>" + "<a href='"+a+"'>" +
//   "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
//    "<p class='specialprice'>"+price +"</p></article>"
// }
            // table += "<article>" + "<a href='"+a+"'>" +
            // "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
            // "<p class='specialprice'>"+price+ "</p></article>";




  //           result = Array.from(texts, v => v.textContent === "" ? '-' : v);
  //
  // console.log(result);

            // document.getElementsByClassName("specialprice")[3] = parseFloat(xmlDoc.getElementsByTagName("price")[3].childNodes[0].nodeValue).toFixed(2);

// console.log(document.getElementsByClassName("specialprice")[3]);
      // let price = parseFloat(x[i].getElementsByTagName("price")[0].childNodes[0].nodeValue).toFixed(2);
      // let title = x[i].getElementsByTagName("title")[0].childNodes[0].nodeValue;
      // let sprice = x[i].getElementsByTagName("specialPrice");
      // let a = x[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
      // let img = x[i].getElementsByTagName("image_link")[0].childNodes[0].nodeValue;
      // table += "<article>" + "<a href='"+a+"'>" +
      // "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + title + "</h5>" +
      //  "<p class='price'>"+ parseFloat(sprice[0].textContent).toFixed(2) +"</></article>";

// document.getElementsByClassName("specialprice").innerHTML = price;
    document.getElementById("demo2").innerHTML = table;
};










        // do{
//   document.getElementsByClassName("specialprice").innerHTML = sprice;
// }
// while(!sprice)
// for(i=0;i <x.length; i++ ){
// if(sprice.textContent !== "undefined"){
// // document.getElementsByClassName("specialPrice").innerHTML = xmlDoc.getElementsByTagName("price")[0].childNodes[0].nodeValue;
// document.getElementsByClassName("specialprice").innerHTML = xmlDoc.getElementsByTagName("specialPrice").textcontent;
// } else{
//
//   // document.getElementsByClassName("specialprice").innerHTML = xmlDoc.getElementsByTagName("specialPrice").textcontent;
//     document.getElementsByClassName("specialPrice").innerHTML = xmlDoc.getElementsByTagName("price")[0].childNodes[0].nodeValue;
// }
//
//
// };



};
// if(sprice !== undefined) {
//   document.getElementsByClassName("specialprice").innerHTML = parseFloat(sprice[0].textContent).toFixed(2);
// } else {
//     document.getElementsByClassName("specialprice").innerHTML = price;
// }
  // document.getElementById("demo").innerHTML = sprice.getAttribute(0);
// document.getElementsByClassName("price").innerHTML = price;
// document.getElementsByClassName("sprice").innerHTML = sprice;
//  var arr = [].slice.call(xmlDoc.getElementsByTagName("specialPrice"));




function resultcount(xml) {
    var xmlDoc = xml.responseXML;
    x = xmlDoc.getElementsByTagName('title').length;
    document.getElementById("results").innerHTML = "Results: " +
    x;
};






// function getimage(xml) {
//   var x, i, path, xmlDoc;
//   xmlDoc = xml.responseXML;
//   path = "";
//
//   for (i = 0; i < y.length; i++) {





// var sprice = x[i].getElementsByTagName("specialPrice")[0];
// var newprice = sprice.filter(function(specialPrice){
// return sprice.nodeValue !== "undefined";
//   });






//
//function myFunction(xml) {
//   var i;
//   var xmlDoc = xml.responseXML;
//   var table="";
//   var x = xmlDoc.getElementsByTagName("item");
//   for (i = 0; i <x.length; i++) {
//     if (sprice.every(function()) {
//       var price = parseFloat(x[i].getElementsByTagName("price")[0].childNodes[0].nodeValue).toFixed(2);
//       var a = x[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
//       var img = x[i].getElementsByTagName("image_link")[0].childNodes[0].nodeValue;
//         table += "<article>" + "<a href='"+a+"'>" +
//         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + x[i].getElementsByTagName("title")[0].childNodes[0].nodeValue + "</h5>" +
//          "<p class='specialprice'>"+sprice.substringData(i, x.length)+"</p>"
//     } else {
//       var sprice = x[i].getElementsByTagName("specialPrice")[0];
//       var price = parseFloat(x[i].getElementsByTagName("price")[0].childNodes[0].nodeValue).toFixed(2);
//       var a = x[i].getElementsByTagName("link")[0].childNodes[0].nodeValue;
//       var img = x[i].getElementsByTagName("image_link")[0].childNodes[0].nodeValue;
//         table += "<article>" + "<a href='"+a+"'>" +
//         "<img class='image' src='"+img+"'>" + "<br/>" + "<h5>" + x[i].getElementsByTagName("title")[0].childNodes[0].nodeValue + "</h5>" +
//          "<p class='price'>"+ price +"</p>"
//     }
//
//        + "<button class='readmore'>Læs mere</button>" + "</a></article>";
//   }
//
//   document.getElementById("demo2").innerHTML = table;
//
// // document.getElementsByClassName("price").innerHTML = price;
// // document.getElementsByClassName("sprice").innerHTML = sprice;
// };

//   }
//   };






//   var nodes = xmlDoc.getElementsByTagName('title'), //Get the var nodes <node> tags
//     amountOfNodes = nodes.length
//
// for(var i = 0; i < amountOfNodes; i++) { //loop thru the nodes
//
//   console.log(nodes[i].getElementsByTagName('title').length); //get the amount of <alarm> tags
//   document.getElementById("results").innerHTML = txt;
// };
// function my(xml) {
//     var x, i, txt, xmlDoc;
//     xmlDoc = xml.responseXML;
//     txt = "";
//     x = xmlDoc.getElementsByTagName("description");
//     for (i = 0; i < x.length; i++) {
//         txt += x[i].childNodes[0].nodeValue + "<br>";
//     }
//     document.getElementById("description").innerHTML = txt;
// }


    // x = xmlDoc.getElementsByTagName('title');
    // xLen = x.length;
    //
    // for (i = 0; i <xLen; i++) {
    //     txt += x[i].childNodes[0].nodeValue) + " ";
    // }

// function myFunction(xml) {
    // var x, i, xmlDoc, txt;
    // xmlDoc = xml.responseXML;
    // txt = "";
    // x = xmlDoc.getElementsByTagName('title');
    // for (i = 0 ; i <x.length; i++) {
    //     txt += x[i].childNodes[0].nodeValue + "<br>";
    // }
    // document.getElementById("demo").innerHTML = txt;

</script>

</body>
</html>
